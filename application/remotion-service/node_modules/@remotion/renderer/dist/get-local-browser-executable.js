"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getLocalBrowserExecutable = void 0;
const node_fs_1 = __importDefault(require("node:fs"));
const BrowserFetcher_1 = require("./browser/BrowserFetcher");
const get_local_browser_1 = require("./get-local-browser");
const getBrowserStatus = (browserExecutablePath) => {
    if (browserExecutablePath) {
        if (!node_fs_1.default.existsSync(browserExecutablePath)) {
            console.warn(`Browser executable was specified as '${browserExecutablePath}' but the path doesn't exist.`);
        }
        return { path: browserExecutablePath, type: 'user-defined-path' };
    }
    const localBrowser = (0, get_local_browser_1.getLocalBrowser)();
    if (localBrowser !== null) {
        return { path: localBrowser, type: 'local-browser' };
    }
    const revision = (0, BrowserFetcher_1.getRevisionInfo)();
    if (revision.local && node_fs_1.default.existsSync(revision.executablePath)) {
        return { path: revision.executablePath, type: 'local-puppeteer-browser' };
    }
    return { type: 'no-browser' };
};
const getLocalBrowserExecutable = (preferredBrowserExecutable) => {
    const status = getBrowserStatus(preferredBrowserExecutable);
    if (status.type === 'no-browser') {
        throw new TypeError('No browser found for rendering frames! Please open a GitHub issue and describe ' +
            'how you reached this error: https://remotion.dev/issue');
    }
    return status.path;
};
exports.getLocalBrowserExecutable = getLocalBrowserExecutable;
